TEST SCRIPT: TS-070
Test Scenario: Update Order Status to Shipped
User Story: As a Logged-in Admin, I want to change order status to Shipped with shipment details, so that I can notify the customer their order is on the way
Priority: Critical
Related Requirements: FR-017

GIVEN the admin is logged in to the admin panel
  AND there is an order with:
    - Order Number: #1002
    - Current Status: "In Process"
    - Customer: Michael Smith (michael.smith@email.com)
    - Order Total: $129.99
  AND the admin is viewing the order details page

WHEN the admin clicks "Update Order Status" button/dropdown
  AND selects "Shipped" from the status options

THEN the system should display a shipment information form with fields:
  - Shipping Carrier (dropdown: UPS, FedEx, USPS, DHL, Other)
  - Tracking Number (text field)
  - Shipment Date (date picker, default: today)
  - Estimated Delivery Date (date picker)
  - Shipping Cost (if not already set)
  - Additional Notes (text area, optional)

WHEN the admin enters shipment details:
  - Carrier: "UPS"
  - Tracking Number: "1Z999AA10123456784"
  - Shipment Date: "2024-11-13"
  - Estimated Delivery: "2024-11-18"
  - Shipping Cost: "$7.50" (already set from order)
  - Notes: "Package includes fragile items"
  AND clicks "Save and Update Status" or "Confirm Shipment"

THEN the system should validate all required fields are filled
  AND update the order record:
    - Status: "In Process" â†’ "Shipped"
    - Status Update Timestamp
  AND create/update shipment record:
    - Order ID
    - Carrier: UPS
    - Tracking Number: 1Z999AA10123456784
    - Shipment Date: 2024-11-13
    - Estimated Delivery: 2024-11-18
    - Shipping Cost: $7.50
    - Notes: "Package includes fragile items"
    - Current Status: "In Transit"
  AND send automated email to michael.smith@email.com with:
    - Subject: "Your order #1002 has been shipped"
    - Order number and summary
    - Tracking information (carrier and tracking number)
    - Estimated delivery date
    - Link to track shipment
  AND display success message: "Order status updated to Shipped successfully"
  AND update the order details page to show new status
  AND show shipment tracking information section

WHEN the customer receives the email and clicks the tracking link

THEN the customer should be able to see:
  - Order tracking page showing shipment details
  - Current shipment status
  - Tracking number with link to carrier's website

WHEN the admin tries to update to Shipped without required shipment details

THEN the system should display validation errors:
  - "Shipping carrier is required"
  - "Tracking number is required"
  AND not update the order status
  AND remain on the same page

EXPECTED RESULT:
- Order status is successfully updated to "Shipped"
- Shipment tracking information is recorded
- Customer receives automated shipment notification email
- Tracking information is accessible to customer
- All required shipment details are validated
- Order history reflects the status change
- Email contains accurate tracking information
